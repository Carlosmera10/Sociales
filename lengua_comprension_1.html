<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen de Comprensión Lectora</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        .container {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 800px;
            padding: 30px;
            box-sizing: border-box;
        }

        h1, h2 {
            color: #1e3a8a;
            text-align: center;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-top: 0;
        }

        #start-screen, #reading-screen, #questions-screen {
            text-align: center;
        }

        .action-button {
            background-color: #2563eb;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            margin: 10px;
        }

        .action-button:hover {
            background-color: #1d4ed8;
            transform: translateY(-2px);
        }
        
        #timer {
            font-size: 24px;
            font-weight: 700;
            color: #d97706;
            background-color: #fef3c7;
            padding: 10px 20px;
            border-radius: 8px;
            margin: 20px auto;
            width: fit-content;
        }

        #reading-text {
            text-align: left;
            font-size: 1.1em;
            line-height: 1.7;
            padding: 20px;
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
        }

        #reading-text p {
            margin-top: 0;
        }

        .question-block {
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: left;
            transition: background-color 0.3s;
        }
        
        .question-block.correct {
            background-color: #dcfce7;
            border-left: 5px solid #22c55e;
        }

        .question-block.incorrect {
            background-color: #fee2e2;
            border-left: 5px solid #ef4444;
        }

        .question-block p {
            font-size: 1.1em;
            font-weight: 600;
            margin: 0 0 15px 0;
        }

        .correction-buttons button {
            border: none;
            padding: 8px 15px;
            margin-right: 10px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s;
        }

        .correction-buttons button:hover {
            transform: scale(1.05);
        }

        .btn-correct {
            background-color: #22c55e;
            color: white;
        }

        .btn-incorrect {
            background-color: #ef4444;
            color: white;
        }

        .answer-text {
            display: none;
            margin-top: 15px;
            padding: 10px;
            background-color: #eef2ff;
            border-radius: 6px;
            border-left: 4px solid #4f46e5;
            font-style: italic;
        }
        
        .answer-text.example {
            background-color: #fef9c3;
            border-left-color: #f59e0b;
        }

        #score-container {
            font-size: 22px;
            font-weight: 700;
            color: #1e3a8a;
            margin-top: 30px;
            text-align: center;
            padding: 15px;
            background-color: #e0e7ff;
            border-radius: 8px;
        }
        
        .main-footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }

        .main-footer a {
            color: #1d4ed8;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
        }

        .main-footer a:hover {
            text-decoration: underline;
        }

        #reading-screen, #questions-screen {
            display: none;
        }
    </style>
</head>
<body>

    <div class="container">
        
        <div id="start-screen">
            <h1>Examen de Comprensión Lectora</h1>
            <p>Lee atentamente las instrucciones:</p>
            <p>Tendrás <strong>2 minutos</strong> para leer el siguiente texto. Una vez que el tiempo termine, el texto desaparecerá y deberás responder a las preguntas.</p>
            <button id="start-button" class="action-button">Comenzar a Leer</button>
        </div>

        <div id="reading-screen">
            <h1>Lee con atención</h1>
            <div id="timer">Tiempo restante: 2:00</div>
            <div id="reading-text">
                <h2>El Secreto del Estanque del Retiro</h2>
                <p>Lucía y Mateo eran inseparables. Cada tarde, después del cole, corrían al Parque del Retiro, su lugar favorito de Madrid. Una tarde de otoño, mientras buscaban castañas cerca del Estanque Grande, algo llamó su atención. Semioculto bajo la raíz de un viejo árbol, había un pequeño cilindro de cuero. Con manos temblorosas, lo abrieron y descubrieron un antiguo pergamino.</p>
                <p>No era un mapa del tesoro cualquiera. Tenía un acertijo: "Donde el sol se mira en un palacio diáfano y la naturaleza es arte, encontrarás mi mayor legado". Los niños se miraron con los ojos brillantes de emoción. ¡Un misterio! Sin dudarlo, supieron que se refería al Palacio de Cristal. Se movieron sigilosamente, como si fueran espías en una misión secreta, sintiendo que la aventura les pertenecía solo a ellos.</p>
                <p>Al llegar, rodearon el increíble edificio de cristal y metal. El sol de la tarde creaba arcoíris en las paredes transparentes. Siguiendo una pequeña marca dibujada en el mapa, encontraron una baldosa suelta detrás de un rosal. Con cuidado, la levantaron. Debajo no había oro ni joyas, sino un pequeño cofre de madera.</p>
                <p>Dentro, encontraron un libro con la cubierta gastada titulado "Leyendas del Retiro" y una nota que decía: "El verdadero tesoro no es el que brilla, sino el que ilumina. Que estas historias te acompañen". Era el legado de un antiguo jardinero del parque que amaba contar historias. Lucía y Mateo sonrieron. Quizás no era el tesoro que esperaban, pero sentían que habían encontrado algo mucho más valioso.</p>
            </div>
        </div>

        <div id="questions-screen">
            <h2>¡Tiempo! Ahora, a responder</h2>
            
            <div class="question-block" id="q1">
                <p>1. ¿Qué encontraron Lucía y Mateo debajo de la raíz de un árbol?</p>
                <div class="correction-buttons">
                    <button class="btn-correct" onclick="markAnswer('q1', true)">✔️ Bien</button>
                    <button class="btn-incorrect" onclick="markAnswer('q1', false)">❌ Mal</button>
                </div>
                <div class="answer-text"></div>
            </div>

            <div class="question-block" id="q2">
                <p>2. Según el acertijo del mapa, ¿a qué lugar del parque debían ir?</p>
                <div class="correction-buttons">
                    <button class="btn-correct" onclick="markAnswer('q2', true)">✔️ Bien</button>
                    <button class="btn-incorrect" onclick="markAnswer('q2', false)">❌ Mal</button>
                </div>
                <div class="answer-text"></div>
            </div>
            
            <div class="question-block" id="q3">
                <p>3. ¿De qué material era el cilindro que encontraron?</p>
                <div class="correction-buttons">
                    <button class="btn-correct" onclick="markAnswer('q3', true)">✔️ Bien</button>
                    <button class="btn-incorrect" onclick="markAnswer('q3', false)">❌ Mal</button>
                </div>
                <div class="answer-text"></div>
            </div>

            <div class="question-block" id="q4">
                <p>4. ¿Por qué crees que los niños se movían "sigilosamente"?</p>
                <div class="correction-buttons">
                    <button class="btn-correct" onclick="markAnswer('q4', true)">✔️ Bien</button>
                    <button class="btn-incorrect" onclick="markAnswer('q4', false)">❌ Mal</button>
                </div>
                <div class="answer-text"></div>
            </div>

            <div class="question-block" id="q5">
                <p>5. En la frase "un palacio diáfano", ¿qué significa la palabra "diáfano"?</p>
                <div class="correction-buttons">
                    <button class="btn-correct" onclick="markAnswer('q5', true)">✔️ Bien</button>
                    <button class="btn-incorrect" onclick="markAnswer('q5', false)">❌ Mal</button>
                </div>
                <div class="answer-text"></div>
            </div>

            <div class="question-block" id="q6">
                <p>6. ¿Crees que Lucía y Mateo se sintieron decepcionados al final? ¿Por qué?</p>
                <div class="correction-buttons">
                    <button class="btn-correct" onclick="markAnswer('q6', true)">✔️ Bien</button>
                    <button class="btn-incorrect" onclick="markAnswer('q6', false)">❌ Mal</button>
                </div>
                <div class="answer-text"></div>
            </div>
            
            <div class="question-block" id="q7">
                <p>7. El jardinero escribió: "El verdadero tesoro no es el que brilla, sino el que ilumina". ¿Qué crees que quería decir?</p>
                <div class="correction-buttons">
                    <button class="btn-correct" onclick="markAnswer('q7', true)">✔️ Bien</button>
                    <button class="btn-incorrect" onclick="markAnswer('q7', false)">❌ Mal</button>
                </div>
                <div class="answer-text"></div>
            </div>
            
            <button id="show-answers-button" class="action-button">Mostrar Respuestas</button>
            <div id="score-container" style="display: none;"></div>
            
            <footer class="main-footer">
                <a href="index.html">🔙 Volver al menú de materias</a>
            </footer>
        </div>
    </div>

    <script>
        const startScreen = document.getElementById('start-screen');
        const readingScreen = document.getElementById('reading-screen');
        const questionsScreen = document.getElementById('questions-screen');
        const startButton = document.getElementById('start-button');
        const timerDisplay = document.getElementById('timer');
        const showAnswersButton = document.getElementById('show-answers-button');
        const scoreContainer = document.getElementById('score-container');

        let timeLeft = 120;
        let timerInterval;
        const totalQuestions = 7;
        let gradedQuestions = {}; // Para evitar contar la misma pregunta varias veces

        const answers = [
            { id: 'q1', text: 'Un pequeño cilindro de cuero con un antiguo pergamino dentro.', isSubjective: false },
            { id: 'q2', text: 'Al Palacio de Cristal.', isSubjective: false },
            { id: 'q3', text: 'De cuero.', isSubjective: false },
            { id: 'q4', text: 'Porque querían mantener su descubrimiento en secreto y sentían que era una misión especial solo para ellos.', isSubjective: true },
            { id: 'q5', text: 'Significa que es transparente o que deja pasar la luz a través de él.', isSubjective: false },
            { id: 'q6', text: 'No, porque aunque no encontraron joyas, descubrieron que las historias y el conocimiento son un tesoro más valioso.', isSubjective: true },
            { id: 'q7', text: 'Quería decir que el conocimiento y las historias son más importantes que el dinero, porque te enseñan y te enriquecen por dentro.', isSubjective: true }
        ];

        startButton.addEventListener('click', startTest);
        showAnswersButton.addEventListener('click', showAnswers);

        function startTest() {
            startScreen.style.display = 'none';
            readingScreen.style.display = 'block';
            startTimer();
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    endReadingPhase();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            let seconds = timeLeft % 60;
            seconds = seconds < 10 ? '0' + seconds : seconds;
            timerDisplay.textContent = `Tiempo restante: ${minutes}:${seconds}`;
        }

        function endReadingPhase() {
            clearInterval(timerInterval);
            readingScreen.style.display = 'none';
            questionsScreen.style.display = 'block';
        }

        function markAnswer(questionId, isCorrect) {
            const questionBlock = document.getElementById(questionId);
            
            if (gradedQuestions[questionId] === undefined) { // Solo se califica la primera vez
                gradedQuestions[questionId] = isCorrect;
            }
            
            questionBlock.classList.remove('correct', 'incorrect');
            if (isCorrect) {
                questionBlock.classList.add('correct');
            } else {
                questionBlock.classList.add('incorrect');
            }
            updateScore();
        }
        
        function updateScore() {
            const correctCount = Object.values(gradedQuestions).filter(val => val === true).length;
            const score = (correctCount / totalQuestions) * 10;
            
            scoreContainer.style.display = 'block';
            scoreContainer.textContent = `Nota final: ${score.toFixed(2)} / 10`;
        }

        function showAnswers() {
            answers.forEach(answer => {
                const questionBlock = document.getElementById(answer.id);
                const answerDiv = questionBlock.querySelector('.answer-text');
                
                let answerContent = answer.text;
                if (answer.isSubjective) {
                    answerDiv.classList.add('example');
                    answerContent = `<strong>Ejemplo de respuesta:</strong> ${answer.text}`;
                }
                
                answerDiv.innerHTML = answerContent;
                answerDiv.style.display = 'block';
            });
        }
    </script>

</body>
</html>
