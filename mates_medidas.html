<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infografía y Examen: Unidades de Medida</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- Estilos Generales (Infografía) --- */
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f4f8fb;
            color: #334e68;
            margin: 0;
            padding: 20px;
        }
        .info-container {
            max-width: 1100px;
            margin: auto;
            background-color: #ffffff;
            border-radius: 24px;
            box-shadow: 0 15px 30px rgba(0, 87, 148, 0.15);
            padding: 20px 40px;
            overflow-x: auto;
        }
        .main-header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 3px dashed #00aaff;
            margin-bottom: 30px;
        }
        .main-header h1 {
            font-size: 3em;
            color: #005a9c;
            margin: 0;
            font-weight: 900;
        }
        .section-title {
            font-size: 2.2em;
            color: #ff7f50;
            text-align: center;
            margin: 40px 0 20px 0;
            font-weight: 700;
        }
        .conversion-guide {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            font-weight: bold;
            font-size: 1.2em;
            flex-wrap: wrap;
            gap: 10px;
        }
        .conversion-guide .operation {
            background-color: #e6f7ff;
            color: #005a9c;
            padding: 8px 15px;
            border-radius: 20px;
            border: 2px solid #00aaff;
        }
        .top-guide {
            color: #d9534f;
        }
         .top-guide .operation {
            background-color: #fff0e6;
            color: #d9534f;
            border-color: #ff7f50;
        }
        .bottom-guide {
            color: #0077cc;
            margin-top: 10px;
        }
        .table-container {
            width: 100%;
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            text-align: center;
        }
        th, td {
            padding: 15px;
            border: 1px solid #bce0ff;
            min-width: 120px;
        }
        thead .unit-names th {
            background-color: #e6f7ff;
            color: #005a9c;
            font-weight: 700;
        }
        tbody tr:nth-child(odd) {
            background-color: #f8fcff;
        }
        .main-unit-cell {
            background-color: #ff7f50;
            color: white;
            font-weight: bold;
            border-left: 4px solid #c0563a;
            border-right: 4px solid #c0563a;
        }
        .time-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .time-card {
            background-color: #fef9e7;
            border: 2px solid #f1c40f;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }
        .time-card-title {
            font-size: 1.8em;
            color: #b8860b;
            margin: 0 0 10px 0;
        }
        .time-card-body {
            font-size: 1.2em;
        }
        .main-footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px 0;
            border-top: 1px solid #e0e0e0;
        }
        .main-footer a {
            text-decoration: none;
            color: #005a9c;
            font-weight: bold;
            background-color: #e6f7ff;
            padding: 10px 20px;
            border-radius: 30px;
            transition: background-color 0.3s;
        }
        .main-footer a:hover {
            background-color: #cceeff;
        }

        /* --- Estilos del Examen --- */
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #50e3c2;
            --correct-color: #28a745;
            --incorrect-color: #dc3545;
            --card-bg: #ffffff;
            --shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .quiz-container {
            max-width: 900px;
            margin: 40px auto;
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: var(--shadow);
            overflow: hidden;
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: #333;
        }
        .quiz-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px;
            text-align: center;
        }
        .quiz-header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .quiz-content {
            padding: 30px;
        }
        .question-block {
            background-color: #fdfdfd;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            transition: all 0.3s ease;
        }
        .question-block:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
        }
        .question-title {
            font-weight: 700;
            font-size: 1.2em;
            margin-bottom: 15px;
        }
        .question-text {
            font-size: 1.1em;
            margin-bottom: 15px;
        }
        .options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .option {
            background-color: #e9ecef;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border: 2px solid transparent;
            flex-grow: 1;
            text-align: center;
        }
        .option:hover {
            background-color: #dbe2e8;
        }
        .option.selected {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            border-color: #3b71b1;
        }
        .matching-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            flex-wrap: wrap;
        }
        .column {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        @media (min-width: 600px) {
            .column {
                width: 48%;
            }
        }
        .match-item {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            text-align: center;
        }
        .match-item:hover {
            background-color: #e9ecef;
        }
        .match-item.selected {
            background-color: var(--secondary-color);
            color: white;
            border-color: #40c0a8;
        }
        .match-item.paired {
            background-color: #6c757d;
            color: white;
            cursor: not-allowed;
            opacity: 0.7;
        }
        .match-item.paired.correct {
            background-color: var(--correct-color);
            opacity: 1;
        }
        .match-item.paired.incorrect {
            background-color: var(--incorrect-color);
            opacity: 1;
        }
        .numeric-input {
            padding: 10px;
            border: 2px solid #ccc;
            border-radius: 8px;
            font-size: 1em;
            width: 150px;
            text-align: center;
            transition: border-color 0.3s;
        }
        .numeric-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        .submit-btn {
            display: block;
            width: 100%;
            padding: 15px;
            font-size: 1.5em;
            font-weight: 700;
            color: white;
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .submit-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .results {
            margin-top: 30px;
            padding: 25px;
            background-color: #e3f2fd;
            border-radius: 10px;
            text-align: center;
            display: none;
        }
        .results h2 {
            margin-top: 0;
            color: var(--primary-color);
            font-size: 2em;
        }
        .results p {
            font-size: 1.2em;
        }
        #final-score {
            font-size: 3em;
            font-weight: 700;
            color: var(--primary-color);
        }
        #feedback-message {
            font-style: italic;
            margin-top: 15px;
            font-size: 1.3em;
        }
        .correct {
            border: 3px solid var(--correct-color) !important;
            background-color: #d4edda !important;
            color: #155724 !important;
        }
        .incorrect {
            border: 3px solid var(--incorrect-color) !important;
            background-color: #f8d7da !important;
            color: #721c24 !important;
        }
        .correct-answer-text {
            font-weight: bold;
            color: var(--correct-color);
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="info-container">
        <header class="main-header">
            <h1>📏 Las Medidas y sus Escaleras ⚖️</h1>
        </header>
        <section>
            <h2 class="section-title">Longitud, Capacidad y Masa 💧</h2>
            <div class="conversion-guide top-guide">
                <span>Para ir a una unidad MENOR</span>
                <div class="operation">x 10 en cada paso ➡️</div>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr class="unit-names">
                            <th>kilo-</th><th>hecto-</th><th>deca-</th><th>UNIDAD</th><th>deci-</th><th>centi-</th><th>mili-</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Kilómetro (km)</td><td>Hectómetro (hm)</td><td>Decámetro (dam)</td><td class="main-unit-cell">Metro (m)</td><td>Decímetro (dm)</td><td>Centímetro (cm)</td><td>Milímetro (mm)</td>
                        </tr>
                        <tr>
                            <td>Kilolitro (kl)</td><td>Hectolitro (hl)</td><td>Decalitro (dal)</td><td class="main-unit-cell">Litro (l)</td><td>Decilitro (dl)</td><td>Centilitro (cl)</td><td>Mililitro (ml)</td>
                        </tr>
                        <tr>
                            <td>Kilogramo (kg)</td><td>Hectogramo (hg)</td><td>Decagramo (dag)</td><td class="main-unit-cell">Gramo (g)</td><td>Decigramo (dg)</td><td>Centigramo (cg)</td><td>Miligramo (mg)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="conversion-guide bottom-guide">
                <div class="operation">⬅️ ÷ 10 en cada paso</div>
                <span>Para ir a una unidad MAYOR</span>
            </div>
        </section>
        <section>
            <h2 class="section-title">⏰ ¡El Tiempo no para! 🗓️</h2>
            <div class="time-grid">
                <div class="time-card"><h3 class="time-card-title">Minuto</h3><p class="time-card-body">1 minuto = 60 segundos</p></div>
                <div class="time-card"><h3 class="time-card-title">Hora</h3><p class="time-card-body">1 hora = 60 minutos</p></div>
                <div class="time-card"><h3 class="time-card-title">Día</h3><p class="time-card-body">1 día = 24 horas</p></div>
                <div class="time-card"><h3 class="time-card-title">Año</h3><p class="time-card-body">1 año = 365 días</p></div>
                <div class="time-card"><h3 class="time-card-title">Lustro</h3><p class="time-card-body">1 lustro = 5 años</p></div>
                <div class="time-card"><h3 class="time-card-title">Década</h3><p class="time-card-body">1 década = 10 años</p></div>
                <div class="time-card"><h3 class="time-card-title">Siglo</h3><p class="time-card-body">1 siglo = 100 años</p></div>
                <div class="time-card"><h3 class="time-card-title">Milenio</h3><p class="time-card-body">1 milenio = 1000 años</p></div>
            </div>
        </section>
    </div>

    <div class="quiz-container">
        <div class="quiz-header">
            <h1>📝 Examen: Problemas con Medidas</h1>
            <p>¡Demuestra lo que has aprendido sobre longitud, masa, capacidad, tiempo y dinero!</p>
        </div>
        <div class="quiz-content">
            <form id="quiz-form">
                
                <!-- PREGUNTAS DE LONGITUD -->
                <div class="question-block"><p class="question-title">1. Conversión de Longitud 📏</p><p class="question-text">3 km y 450 m, ¿cuántos metros son en total?</p><input type="number" class="numeric-input" data-question-id="1" data-answer="3450"></div>
                <div class="question-block"><p class="question-title">2. Comparación de Longitud ↔️</p><p class="question-text">¿Qué es más largo?</p><div class="options" data-question-id="2" data-correct="2 km y 600 m"><div class="option">2.500 m</div><div class="option">2 km y 600 m</div></div></div>
                <div class="question-block"><p class="question-title">3. Suma de Longitudes ➕</p><p class="question-text">Si das un paseo de 1 km y 200 m, y luego otro de 800 m, ¿cuántos metros has recorrido en total?</p><input type="number" class="numeric-input" data-question-id="3" data-answer="2000"></div>
                <div class="question-block"><p class="question-title">4. Verdadero o Falso (Longitud) ✅❌</p><p class="question-text">Un metro es igual a 1.000 milímetros.</p><div class="options" data-question-id="4" data-correct="Verdadero"><div class="option">Verdadero</div><div class="option">Falso</div></div></div>
                <!-- PREGUNTAS DE MASA -->
                <div class="question-block"><p class="question-title">5. Conversión de Masa ⚖️</p><p class="question-text">Un saco de patatas pesa 5 kg. ¿Cuántos gramos son?</p><input type="number" class="numeric-input" data-question-id="5" data-answer="5000"></div>
                <div class="question-block"><p class="question-title">6. Unidad de Masa Adecuada 🍎</p><p class="question-text">Para pesar una manzana, ¿qué unidad usarías?</p><div class="options" data-question-id="6" data-correct="Gramos"><div class="option">Kilogramos</div><div class="option">Gramos</div><div class="option">Litros</div></div></div>
                <div class="question-block"><p class="question-title">7. Verdadero o Falso (Masa) ✅❌</p><p class="question-text">Medio kilo (0,5 kg) es lo mismo que 50 gramos.</p><div class="options" data-question-id="7" data-correct="Falso"><div class="option">Verdadero</div><div class="option">Falso</div></div></div>
                <div class="question-block"><p class="question-title">8. Problema de Masa 📦</p><p class="question-text">¿Cuántos paquetes de 250 g se pueden hacer con 1 kg de café?</p><input type="number" class="numeric-input" data-question-id="8" data-answer="4"></div>
                <!-- PREGUNTAS DE CAPACIDAD -->
                <div class="question-block"><p class="question-title">9. Conversión de Capacidad 💧</p><p class="question-text">Una botella contiene 2 litros de agua. ¿Cuántos centilitros (cL) son?</p><input type="number" class="numeric-input" data-question-id="9" data-answer="200"></div>
                <div class="question-block"><p class="question-title">10. Comparación de Capacidad 🥤</p><p class="question-text">¿Qué cantidad es igual a 1 litro?</p><div class="options" data-question-id="10" data-correct="100 cL"><div class="option">10 cL</div><div class="option">100 cL</div><div class="option">1.000 cL</div></div></div>
                <div class="question-block"><p class="question-title">11. Problema de Capacidad 🥛</p><p class="question-text">Con una botella de 2 litros, ¿cuántos vasos de 25 cL puedes llenar?</p><input type="number" class="numeric-input" data-question-id="11" data-answer="8"></div>
                <div class="question-block"><p class="question-title">12. Verdadero o Falso (Capacidad) ✅❌</p><p class="question-text">Un decalitro (dal) son 100 litros.</p><div class="options" data-question-id="12" data-correct="Falso"><div class="option">Verdadero</div><div class="option">Falso</div></div></div>
                <!-- PREGUNTAS DE TIEMPO -->
                <div class="question-block"><p class="question-title">13. Cálculo de Intervalo de Tiempo ⏰</p><p class="question-text">Si una película empieza a las 17:15 y termina a las 19:00, ¿cuántos minutos ha durado?</p><input type="number" class="numeric-input" data-question-id="13" data-answer="105"></div>
                <div class="question-block"><p class="question-title">14. Conversión de Tiempo ⏱️</p><p class="question-text">¿Cuántos segundos son 3 minutos y 10 segundos?</p><input type="number" class="numeric-input" data-question-id="14" data-answer="190"></div>
                <div class="question-block"><p class="question-title">15. Verdadero o Falso (Tiempo) ✅❌</p><p class="question-text">Un lustro son 10 años.</p><div class="options" data-question-id="15" data-correct="Falso"><div class="option">Verdadero</div><div class="option">Falso</div></div></div>
                <div class="question-block"><p class="question-title">16. Equivalencia de Tiempo 🔄</p><p class="question-text">¿Cuántas horas son 180 minutos?</p><div class="options" data-question-id="16" data-correct="3 horas"><div class="option">2 horas</div><div class="option">3 horas</div><div class="option">4 horas</div></div></div>
                <!-- PREGUNTAS DE DINERO -->
                <div class="question-block"><p class="question-title">17. Cálculo con Dinero 💶</p><p class="question-text">Si compras un libro que cuesta 12,50 € y pagas con un billete de 20 €, ¿cuántos euros te devuelven? (Usa un punto para los decimales, ej: 7.50)</p><input type="number" step="0.01" class="numeric-input" data-question-id="17" data-answer="7.50"></div>
                <div class="question-block"><p class="question-title">18. Suma de Monedas 💰</p><p class="question-text">Tienes una moneda de 2€, tres de 50 céntimos y cuatro de 10 céntimos. ¿Cuánto dinero tienes en total? (Usa un punto para los decimales, ej: 3.90)</p><input type="number" step="0.01" class="numeric-input" data-question-id="18" data-answer="3.90"></div>
                <div class="question-block"><p class="question-title">19. Problema de Dinero 🛒</p><p class="question-text">Un kilo de manzanas cuesta 1,80 €. ¿Cuánto cuestan 3 kilos? (Usa un punto para los decimales, ej: 5.40)</p><input type="number" step="0.01" class="numeric-input" data-question-id="19" data-answer="5.40"></div>
                <div class="question-block"><p class="question-title">20. Verdadero o Falso (Dinero) ✅❌</p><p class="question-text">Con 3 monedas de 50 céntimos tienes más dinero que con una moneda de 2 euros.</p><div class="options" data-question-id="20" data-correct="Falso"><div class="option">Verdadero</div><div class="option">Falso</div></div></div>
                <!-- PREGUNTAS DE EMPAREJAR -->
                <div class="question-block"><p class="question-title">21. Emparejar: Objeto y Longitud 📏</p><p class="question-text">Une cada objeto con su unidad de longitud más lógica.</p><div class="matching-question" data-question-id="21"><div class="matching-container"><div class="column" id="column-a-21"><div class="match-item" data-match-id="1">🛣️ Carretera entre ciudades</div><div class="match-item" data-match-id="2">✏️ Un lápiz</div><div class="match-item" data-match-id="3">🏊 Una piscina olímpica</div></div><div class="column" id="column-b-21"></div></div></div></div>
                <div class="question-block"><p class="question-title">22. Emparejar: Objeto y Masa ⚖️</p><p class="question-text">Une cada objeto con su unidad de masa más lógica.</p><div class="matching-question" data-question-id="22"><div class="matching-container"><div class="column" id="column-a-22"><div class="match-item" data-match-id="1">🚚 Un camión</div><div class="match-item" data-match-id="2">🧑 Una persona</div><div class="match-item" data-match-id="3">💍 Un anillo</div></div><div class="column" id="column-b-22"></div></div></div></div>
                <div class="question-block"><p class="question-title">23. Emparejar: Recipiente y Capacidad 💧</p><p class="question-text">Une cada recipiente con su unidad de capacidad más lógica.</p><div class="matching-question" data-question-id="23"><div class="matching-container"><div class="column" id="column-a-23"><div class="match-item" data-match-id="1">🥄 Una cuchara</div><div class="match-item" data-match-id="2">🍼 Una botella de agua</div><div class="match-item" data-match-id="3">🌊 Una piscina</div></div><div class="column" id="column-b-23"></div></div></div></div>
                <div class="question-block"><p class="question-title">24. Emparejar: Periodo y Tiempo 🗓️</p><p class="question-text">Une cada periodo con su duración correcta.</p><div class="matching-question" data-question-id="24"><div class="matching-container"><div class="column" id="column-a-24"><div class="match-item" data-match-id="1">💯 Un siglo</div><div class="match-item" data-match-id="2">🌷 Un trimestre</div><div class="match-item" data-match-id="3">📅 Una semana</div></div><div class="column" id="column-b-24"></div></div></div></div>
                <!-- MÁS PREGUNTAS VARIADAS -->
                <div class="question-block"><p class="question-title">25. Conversión Compleja a Simple (Longitud) 📏</p><p class="question-text">¿Cuántos centímetros son 5 metros y 25 centímetros?</p><input type="number" class="numeric-input" data-question-id="25" data-answer="525"></div>
                <div class="question-block"><p class="question-title">26. Comparación de Masa ⚖️</p><p class="question-text">¿Qué pesa más?</p><div class="options" data-question-id="26" data-correct="1.300 gramos"><div class="option">1 kg y 200 gramos</div><div class="option">1.300 gramos</div></div></div>
                <div class="question-block"><p class="question-title">27. Resta de Capacidad 💧</p><p class="question-text">De una jarra de 1 litro y medio (1.500 ml), sirvo un vaso de 250 ml. ¿Cuántos mililitros quedan?</p><input type="number" class="numeric-input" data-question-id="27" data-answer="1250"></div>
                <div class="question-block"><p class="question-title">28. Hora en Reloj Digital</p><p class="question-text">Un tren sale a las 8:45 de la mañana y el viaje dura 90 minutos. ¿A qué hora llega?</p><div class="options" data-question-id="28" data-correct="10:15"><div class="option">10:00</div><div class="option">10:15</div><div class="option">10:30</div></div></div>
                <div class="question-block"><p class="question-title">29. Elegir Frase Correcta (Dinero) 💶</p><p class="question-text">Un juguete cuesta 5,75 €. Elige la afirmación correcta:</p><div class="options" data-question-id="29" data-correct="Cuesta cinco euros y setenta y cinco céntimos."><div class="option">Cuesta cinco euros y setenta y cinco billetes.</div><div class="option">Cuesta cinco euros y setenta y cinco céntimos.</div><div class="option">Cuesta cinco céntimos y setenta y cinco euros.</div></div></div>
                <div class="question-block"><p class="question-title">30. Problema de Medidas Combinadas 🏃‍♂️</p><p class="question-text">Carlos corre 3 km y 500 m cada día. ¿Cuántos metros corre en una semana (7 días)?</p><input type="number" class="numeric-input" data-question-id="30" data-answer="24500"></div>

            </form>
            <button type="submit" form="quiz-form" class="submit-btn">¡Terminar y Corregir!</button>
            <div class="results" id="results-container">
                <h2>Resultados del Examen</h2>
                <p>Tu puntuación final es:</p>
                <p id="final-score">0 / 10</p>
                <p id="feedback-message">¡Sigue intentándolo!</p>
            </div>
        </div>
    </div>

    <footer class="main-footer">
        <a href="index.html">🔙 Volver al menú de materias</a>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('quiz-form');
        const resultsContainer = document.getElementById('results-container');
        const finalScoreElement = document.getElementById('final-score');
        const feedbackMessageElement = document.getElementById('feedback-message');

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        document.querySelectorAll('.options').forEach(optionsContainer => {
            const options = Array.from(optionsContainer.children);
            shuffle(options);
            options.forEach(option => optionsContainer.appendChild(option));
        });

        const matchingData = {
            '21': [{ id: '1', text: 'Kilómetros (km)' },{ id: '2', text: 'Centímetros (cm)' },{ id: '3', text: 'Metros (m)' }],
            '22': [{ id: '1', text: 'Kilogramos (kg)' },{ id: '2', text: 'Kilogramos (kg)' },{ id: '3', text: 'Gramos (g)' }],
            '23': [{ id: '1', text: 'Mililitros (ml)' },{ id: '2', text: 'Litros (l)' },{ id: '3', text: 'Kilolitros (kl)' }],
            '24': [{ id: '1', text: '100 años' },{ id: '2', text: '3 meses' },{ id: '3', text: '7 días' }]
        };

        document.querySelectorAll('.matching-question').forEach(question => {
            const questionId = question.dataset.questionId;
            const columnB = document.getElementById(`column-b-${questionId}`);
            const itemsB = shuffle([...matchingData[questionId]]);
            itemsB.forEach(itemData => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'match-item';
                itemDiv.dataset.matchId = itemData.id;
                itemDiv.textContent = itemData.text;
                columnB.appendChild(itemDiv);
            });
        });

        let selectedItem = null;
        document.querySelectorAll('.match-item').forEach(item => {
            item.addEventListener('click', () => {
                if (item.classList.contains('paired')) return;
                const currentColumn = item.parentElement;
                if (selectedItem) {
                    if (selectedItem.parentElement === currentColumn) {
                        selectedItem.classList.remove('selected');
                        selectedItem = item.classList.contains('selected') ? null : item;
                        item.classList.toggle('selected');
                    } else {
                        item.classList.add('paired');
                        selectedItem.classList.add('paired');
                        selectedItem.dataset.pairedWith = item.dataset.matchId;
                        item.dataset.pairedWith = selectedItem.dataset.matchId;
                        selectedItem.classList.remove('selected');
                        selectedItem = null;
                    }
                } else {
                    item.classList.add('selected');
                    selectedItem = item;
                }
            });
        });

        document.querySelectorAll('.options .option').forEach(item => {
            item.addEventListener('click', event => {
                const parent = event.target.parentElement;
                if (parent.classList.contains('multiple-choice')) {
                    event.target.classList.toggle('selected');
                } else {
                    parent.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
                    event.target.classList.add('selected');
                }
            });
        });

        form.addEventListener('submit', event => {
            event.preventDefault();
            calculateAndShowResults();
        });

        function calculateAndShowResults() {
            let score = 0;
            const totalQuestions = 30;

            document.querySelectorAll('.numeric-input').forEach(input => {
                const userAnswer = parseFloat(input.value.replace(',', '.'));
                const correctAnswer = parseFloat(input.dataset.answer);
                input.classList.remove('correct', 'incorrect');
                if (userAnswer === correctAnswer) {
                    score++;
                    input.classList.add('correct');
                } else {
                    input.classList.add('incorrect');
                    const helpText = document.createElement('span');
                    helpText.className = 'correct-answer-text';
                    helpText.textContent = `✔️ Respuesta: ${input.dataset.answer}`;
                    if (!input.nextElementSibling || !input.nextElementSibling.classList.contains('correct-answer-text')) {
                        input.insertAdjacentElement('afterend', helpText);
                    }
                }
            });

            document.querySelectorAll('.options').forEach(container => {
                const selected = container.querySelector('.option.selected');
                const correctAnswer = container.dataset.correct;
                container.querySelectorAll('.option').forEach(opt => opt.classList.remove('correct', 'incorrect'));
                if (selected) {
                    if (selected.textContent.trim() === correctAnswer.trim()) {
                        score++;
                        selected.classList.add('correct');
                    } else {
                        selected.classList.add('incorrect');
                        Array.from(container.querySelectorAll('.option')).find(opt => opt.textContent.trim() === correctAnswer.trim()).classList.add('correct');
                    }
                } else {
                     Array.from(container.querySelectorAll('.option')).find(opt => opt.textContent.trim() === correctAnswer.trim()).classList.add('correct');
                }
            });
            
            document.querySelectorAll('.matching-question').forEach(question => {
                const questionId = question.dataset.questionId;
                const columnAItems = document.querySelectorAll(`#column-a-${questionId} .match-item`);
                let questionScore = 0;
                let totalPairs = columnAItems.length;
                columnAItems.forEach(itemA => {
                    itemA.classList.remove('correct', 'incorrect');
                    const itemA_id = itemA.dataset.matchId;
                    const columnB = document.getElementById(`column-b-${questionId}`);
                    const itemB = Array.from(columnB.children).find(child => child.dataset.pairedWith === itemA_id);
                    if (itemB) {
                        itemB.classList.remove('correct', 'incorrect');
                        if (itemA_id === itemB.dataset.matchId) {
                            questionScore++;
                            itemA.classList.add('correct');
                            itemB.classList.add('correct');
                        } else {
                            itemA.classList.add('incorrect');
                            itemB.classList.add('incorrect');
                        }
                    } else {
                         itemA.classList.add('incorrect');
                    }
                });
                if(questionScore === totalPairs) {
                    score++;
                }
            });

            const finalGrade = ((score / totalQuestions) * 10).toFixed(2);
            finalScoreElement.textContent = `${finalGrade} / 10`;
            let message = "";
            let emoji = "";
            if (finalGrade >= 9) {
                message = "¡Excelente trabajo! ¡Eres un genio de las medidas! 🏆";
            } else if (finalGrade >= 7) {
                message = "¡Muy bien! Sigue así y serás imparable. 👍";
            } else if (finalGrade >= 5) {
                message = "¡Aprobado! Has hecho un buen esfuerzo, ¡a por el sobresaliente! 😊";
            } else {
                emoji = "💩 ";
                message = "¡Oh, no! Necesitas repasar un poco más. ¡No te rindas, tú puedes!";
            }
            feedbackMessageElement.textContent = emoji + message;
            resultsContainer.style.display = 'block';
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        }
    });
    </script>
</body>
</html>
